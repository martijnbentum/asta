{% extends "texts/base.html" %}

{%load static %}
{%block head %}
	<link rel="stylesheet" href="{% static 'texts/annotate.css' %}" />
{% endblock %}


{% block content %}
{{ocrline.start_time|json_script:'start-time'}}
{{ocrline.end_time|json_script:'end-time'}}
{{ocrline.align.recording.web_wav|json_script:'web-wav'}}

<div class="title-parent">
    <div class="title-child">
        <h4>
            {{ocrline.align.recording.name}}
            <small class="grey">
                ({{ocrline.align.recording.province.name}} | 
                {{ocrline.align.recording.area}} |
                {{ocrline.align.recording.duration_str}})
            </small>
        </h4>
    </div>
    <div class="title-child right">
        <p>
            <a class="btn btn-link" onclick="play()">
                <i class="fa fa-angle-left"></i>
            </a>
            {{line_index}} / {{nocrlines}}
            <a class="btn btn-link" onclick="play()">
                <i class="fa fa-angle-right"></i>
            </a>
        </p>
    </div>
</div>
<hr>
<br>

<a class="btn btn-link" onclick="play()">
    <i class="fas fa-play"></i>
</a>

<p class="ocr-text">
{{ocrline.transcription.text_clean}}
</p>
<br>
<br>

<audio 
    id = "audio"
	src="/{{a.recording.web_wav}}#t={{o.start_time}},{{o.end_time}}"
	type="audio/x-wav"
    >
	your browser does not support the audio element
</audio>

<form method='post'>
	{% csrf_token %}
	<table class="table table-borderless table-sm">
		<tr class="d-flex">
			<td class="col-2">
				<button 
					class="btn btn-danger"
					type='submit' onclick="set_quality('bad')" 
					value="bad"><b>b</b>ad
				</button>
			</td>
			<td class="col-3">
				<button 
					class="btn btn-warning"
					type='submit' onclick="set_quality('start_match')" 
					value="start"><b>s</b>tart match
				</button>
			</td>
			<td class="col-3">
				<button 
					class="btn btn-warning"
					type='submit' onclick="set_quality('middle_match')" 
					value="middle"><b>m</b>iddle match
				</button>
			</td>
			<td class="col-3">
				<button 
					class="btn btn-warning"
					type='submit' onclick="set_quality('end_match')" 
					value="end"><b>e</b>nd match
				</button>
			</td>
			<td class="col-2">
				<button 
					class="btn btn-success"
					type='submit' onclick="set_quality('good')" 
					value="good"><b>g</b>ood
				</button>
			</td>
		</tr>
	</table>
	<input type="hidden" name="quality" id="quality" value = "">
</form>

<br>
<hr>
<br><br>

<p class='align'>
OCR: {{ocrline.ocr_align_text}}
</p>
<p class='align'>
ASR: {{ocrline.asr_align_text}}
</p>
<p class='right mismatch'>
<small class="grey">Align match: </small>{{ocrline.align_match}}
</p>

<br><br>
<br><br>
<p class="grey small">
start
{{location}}
{{location_type}}
{{exclude}}
{{minimum_match}}
{{perc_lines}}
{{record_index}}
{{line_index}}
{{ocrline.align.recording.web_wav}}
{{ocrline.start_time}}
{{ocrline.end_time}}
end
</p>

<input 
    type="hidden" name="line_index" 
    id="line_index" value = "{{line_index}}">
<input 
    type="hidden" name="record_index" 
    id="record_index" value = "{{record_index}}">

<script>
</script>
<script src="{% static 'texts/annotate.js' %}"></script>
{% endblock %}
